!

!
upgrade fpd auto
version 12.4
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname S1
!
boot-start-marker
boot-end-marker
!
logging message-counter syslog
logging console informational
logging monitor informational
enable secret 5 $1$s2PH$5.e1A1eLVVMP.FZZmWzgE0
!
aaa new-model
!
!
aaa group server radius RADIUS-GROUP
 server 200.200.3.2 auth-port 1645 acct-port 1646
!
aaa authentication login default local
aaa authentication login RADIUS-LOGIN group RADIUS-GROUP local
!
!
aaa session-id common
clock timezone swe 2
ip source-route
no ip icmp rate-limit unreachable
ip cef
ip slb serverfarm DMZ_WEBSERVERS
 nat server
 predictor leastconns
 real 200.200.2.2
  inservice
 real 200.200.4.2
  inservice
!
ip slb vserver INT_WEBSERVER
 virtual 200.200.6.2 tcp www
 serverfarm DMZ_WEBSERVERS
 inservice
!
!
!
!
!
ip domain list malta.rodingen.com
ip domain name rodingen.com
ip name-server 200.200.3.2
no ipv6 cef
!
multilink bundle-name authenticated
!
!
voice dsp waitstate 0
!
!
!
!
!
!
!
!
!
!
!
!
!
memory-size iomem 0
username gruppd password 0 gruppd
archive
 log config
  hidekeys
! 
!
!
!
!
ip tcp synwait-time 5
ip ssh version 2
!
class-map type inspect match-any INSIDE-SERVICES-CMAP
 match access-group name INSIDE-SERVICES
class-map type inspect match-any DMZ-TO-OUTSIDE-PROT-CMAP
 match protocol icmp
class-map type inspect match-any OUTSIDE-TO-DMZ2-PROT-CMAP
 match protocol dns
 match protocol radius
 match protocol pptp
class-map type inspect match-all OUTSIDE-TO-DMZ2-CMAP
 match access-group name OUTSIDE-TO-DMZ2
 match class-map OUTSIDE-TO-DMZ2-PROT-CMAP
class-map type inspect match-any RADIUS-PROT-CMAP
 match protocol radius
 match protocol syslog
 match protocol udp
class-map type inspect match-any MANAGEMENT-CMAP
 match access-group name MANAGEMENT
 match protocol icmp
class-map type inspect match-any MANAGEMENT-TO-SELF-CMAP
 match class-map MANAGEMENT-CMAP
class-map type inspect match-any DMZ2-TO-OUTSIDE-PROT-CMAP
 match protocol icmp
 match protocol mysql
class-map type inspect match-all RADIUS-CMAP
 match class-map RADIUS-PROT-CMAP
 match access-group name RADIUS-ACL
class-map type inspect match-any ALLOWED-PROT-CMAP
 match protocol http
 match protocol https
 match protocol icmp
 match protocol mysql
class-map type inspect match-all OUTSIDE-TO-DMZ-CMAP
 match access-group name FW-HTTP
 match class-map ALLOWED-PROT-CMAP
class-map type inspect match-all OSPF-CMAP
 match access-group name OSPF
class-map type inspect match-any OUTSIDE-TO-INSIDE-PROT-CMAP
 match protocol icmp
 match protocol pptp
 match protocol dns
 match protocol http
 match protocol https
 match protocol ntp
class-map type inspect match-all OUTSIDE-TO-INSIDE-CMAP
 match class-map OUTSIDE-TO-INSIDE-PROT-CMAP
 match access-group name OUTSIDE-TO-INSIDE
class-map type inspect match-any OUTSIDE-TO-INSIDE-MAPS-CMAP
 match class-map RADIUS-CMAP
 match class-map OUTSIDE-TO-INSIDE-CMAP
class-map type inspect match-any INSIDE-TO-DMZ-PROT-CMAP
 match protocol icmp
 match protocol http
 match protocol https
 match protocol mysql
 match protocol dhcp-failover
 match protocol syslog
class-map type inspect match-any DMZ-TO-INSIDE-PROT-CMAP
 match protocol icmp
 match protocol syslog
 match protocol mysql
 match protocol http
 match protocol https
 match protocol dhcp-failover
 match protocol tcp
 match protocol ntp
 match protocol udp
class-map type inspect match-any INSIDE-TO-DMZ2-PROT-CMAP
 match protocol dns
 match protocol ldap
 match protocol mysql
 match protocol ssh
 match protocol icmp
class-map type inspect match-all INSIDE-TO-DMZ2-CMAP
 match class-map INSIDE-TO-DMZ2-PROT-CMAP
 match access-group name INSIDE-TO-DMZ2
class-map type inspect match-any INSIDE-TO-OUTSIDE-PROT-CMAP
 match protocol http
 match protocol https
 match protocol dns
 match protocol icmp
class-map type inspect match-any DMZ2-TO-INSIDE-PROT-CMAP
 match protocol ldap
 match protocol dns
 match protocol radius
 match protocol icmp
class-map type inspect match-all INSIDE-TO-OUTSIDE-CMAP
 match access-group name INSIDE-TO-OUTSIDE
 match class-map INSIDE-TO-OUTSIDE-PROT-CMAP
class-map type inspect match-all INSIDE-TO-DMZ-CMAP
 match access-group name INSIDE-TO-DMZ
 match class-map INSIDE-TO-DMZ-PROT-CMAP
class-map type inspect match-all DMZ-TO-INSIDE-CMAP
 match access-group name DMZ-TO-INSIDE
 match class-map DMZ-TO-INSIDE-PROT-CMAP
!
!
policy-map type inspect OUTSIDE-TO-DMZ2-POLICY
 class type inspect OUTSIDE-TO-DMZ2-CMAP
  inspect 
 class class-default
  pass log
policy-map type inspect DMZ2-TO-OUTSIDE-POLICY
 class type inspect DMZ2-TO-OUTSIDE-PROT-CMAP
  inspect 
 class class-default
  pass log
policy-map type inspect DMZ-TO-DMZ-POLICY1
 class class-default
  pass log
policy-map type inspect DMZ-TO-OUTSIDE-POLICY
 class type inspect DMZ-TO-OUTSIDE-PROT-CMAP
  inspect 
 class class-default
  pass log
policy-map type inspect OUTSIDE-TO-DMZ-POLICY
 class type inspect OUTSIDE-TO-DMZ-CMAP
  pass
 class class-default
  pass log
policy-map type inspect DMZ-TO-DMZ-POLICY
 class class-default
  pass log
policy-map type inspect MANAGEMENT-TO-SELF-POLICY
 class type inspect MANAGEMENT-TO-SELF-CMAP
  inspect 
 class class-default
  pass log
policy-map type inspect INSIDE-TO-DMZ2-POLICY
 class type inspect INSIDE-TO-DMZ2-CMAP
  inspect 
 class type inspect RADIUS-CMAP
  inspect 
 class class-default
  pass log
policy-map type inspect DMZ2-TO-INSIDE-POLICY
 class type inspect DMZ2-TO-INSIDE-PROT-CMAP
  inspect 
 class class-default
  pass log
policy-map type inspect INSIDE-TO-DMZ-POLICY
 class type inspect INSIDE-TO-DMZ-CMAP
  inspect 
 class type inspect INSIDE-SERVICES-CMAP
  inspect 
 class class-default
  pass log
policy-map type inspect DMZ-TO-INSIDE-POLICY
 class type inspect DMZ-TO-INSIDE-CMAP
  inspect 
 class class-default
  pass log
policy-map type inspect INSIDE-TO-OUTSIDE-POLICY
 class type inspect INSIDE-TO-OUTSIDE-CMAP
  inspect 
 class type inspect OSPF-CMAP
  pass
 class class-default
  pass log
policy-map type inspect OUTSIDE-TO-INSIDE-POLICY
 class type inspect OUTSIDE-TO-INSIDE-MAPS-CMAP
  inspect 
 class type inspect OSPF-CMAP
  pass
 class class-default
  pass log
!
zone security OUTSIDE
zone security INSIDE
zone security DMZ
zone security DMZ2
zone-pair security OUTSIDE-INSIDE-ZP source OUTSIDE destination INSIDE
 service-policy type inspect OUTSIDE-TO-INSIDE-POLICY
zone-pair security INSIDE-OUTSIDE-ZP source INSIDE destination OUTSIDE
 service-policy type inspect INSIDE-TO-OUTSIDE-POLICY
zone-pair security DMZ-INSIDE-ZP source DMZ destination INSIDE
 service-policy type inspect DMZ-TO-INSIDE-POLICY
zone-pair security INSIDE-DMZ-ZP source INSIDE destination DMZ
 service-policy type inspect INSIDE-TO-DMZ-POLICY
zone-pair security DMZ-OUTSIDE-ZP source DMZ destination OUTSIDE
zone-pair security OUTSIDE-DMZ-ZP source OUTSIDE destination DMZ
 service-policy type inspect OUTSIDE-TO-DMZ-POLICY
zone-pair security DMZ2-INSIDE-ZP source DMZ2 destination INSIDE
 service-policy type inspect DMZ2-TO-INSIDE-POLICY
zone-pair security INSIDE-DMZ2-ZP source INSIDE destination DMZ2
 service-policy type inspect INSIDE-TO-DMZ2-POLICY
zone-pair security OUTSIDE-DMZ2-ZP source OUTSIDE destination DMZ2
 service-policy type inspect OUTSIDE-TO-DMZ2-POLICY
zone-pair security DMZ2-OUTSIDE-ZP source DMZ2 destination OUTSIDE
 service-policy type inspect DMZ2-TO-OUTSIDE-POLICY
zone-pair security OUTSIDE-SELF-ZP source OUTSIDE destination self
 service-policy type inspect MANAGEMENT-TO-SELF-POLICY
zone-pair security DMZ-SELF-ZP source DMZ destination self
 service-policy type inspect MANAGEMENT-TO-SELF-POLICY
zone-pair security INSIDE-SELF-ZP source INSIDE destination self
 service-policy type inspect MANAGEMENT-TO-SELF-POLICY
zone-pair security DMZ-DMZ-ZP source DMZ destination DMZ2
 service-policy type inspect DMZ-TO-DMZ-POLICY
zone-pair security DMZ-DMZ-ZP1 source DMZ2 destination DMZ
 service-policy type inspect DMZ-TO-DMZ-POLICY1
!
!
!
!
interface Loopback0
 description MANAGEMENT
 ip address 200.200.16.4 255.255.255.0
!
interface FastEthernet0/0
 description TO-R1
 ip address 200.200.6.2 255.255.255.252
 ip ospf authentication message-digest
 ip ospf message-digest-key 1 md5 gruppd
 ip ospf 1653 area 0
 duplex full
!
interface FastEthernet1/0
 description TO-S3
 ip address 200.200.9.1 255.255.255.252
 ip ospf authentication message-digest
 ip ospf message-digest-key 1 md5 gruppd
 duplex full
 speed 100
!
interface FastEthernet1/1
 description TO-S2
 ip address 200.200.8.1 255.255.255.252
 ip ospf authentication message-digest
 ip ospf message-digest-key 1 md5 gruppd
 duplex full
 speed 100
!
interface FastEthernet2/0
 description TO-S4
 ip address 200.200.12.1 255.255.255.252
 ip ospf authentication message-digest
 ip ospf message-digest-key 1 md5 gruppd
 duplex auto
 speed auto
!
interface FastEthernet2/1
 description TO-TORSK
 ip address 200.200.1.1 255.255.255.252
 duplex auto
 speed auto
!
interface FastEthernet3/0
 description TO-Sill
 ip address 200.200.2.1 255.255.255.252
 duplex auto
 speed auto
!
interface FastEthernet3/1
 no ip address
 shutdown
 duplex auto
 speed auto
!
interface FastEthernet4/0
 no ip address
 shutdown
 duplex auto
 speed auto
!
interface FastEthernet4/1
 no ip address
 shutdown
 duplex auto
 speed auto
!
interface FastEthernet5/0
 no ip address
 shutdown
 duplex auto
 speed auto
!
interface FastEthernet5/1
 no ip address
 shutdown
 duplex auto
 speed auto
!
router ospf 1653
 router-id 200.200.16.4
 log-adjacency-changes
 passive-interface default
 no passive-interface FastEthernet0/0
 no passive-interface FastEthernet1/0
 no passive-interface FastEthernet1/1
 no passive-interface FastEthernet2/0
 network 200.200.1.0 0.0.0.3 area 0
 network 200.200.2.0 0.0.0.3 area 0
 network 200.200.6.0 0.0.0.3 area 0
 network 200.200.8.0 0.0.0.3 area 0
 network 200.200.9.0 0.0.0.3 area 0
 network 200.200.12.0 0.0.0.3 area 0
 network 200.200.16.4 0.0.0.0 area 0
!
ip forward-protocol nd
ip route 200.200.18.0 255.255.255.0 200.200.3.2
no ip http server
no ip http secure-server
!
!
!
ip access-list extended BRANCH-ACL
 permit ip 200.50.1.0 0.0.0.255 host 200.200.3.2
 permit ip 200.60.1.0 0.0.0.255 host 20.200.3.2
ip access-list extended DMZ-TO-INSIDE
 permit tcp host 200.200.2.2 host 200.200.4.2 eq 847
 permit tcp host 200.200.4.2 host 200.200.2.2 eq 847
 permit ip host 200.200.2.2 host 200.200.4.2
 permit ip host 200.200.4.2 host 200.200.2.2
 permit udp host 200.200.2.2 host 200.200.3.2 eq domain
ip access-list extended FW-HTTP
 permit tcp any host 200.200.2.2 eq www
 permit tcp any host 200.200.4.2 eq www
 permit tcp any host 200.200.6.2 eq www
 permit tcp any host 200.200.7.2 eq www
ip access-list extended INSIDE-SERVICES
 permit tcp host 200.200.2.2 host 200.200.4.2 eq 847
 permit tcp host 200.200.4.2 host 200.200.2.2 eq 847
 permit udp 200.200.0.0 0.0.255.255 host 200.200.2.2 eq ntp
 permit udp 200.200.16.0 0.0.0.255 host 200.200.2.2 eq syslog
ip access-list extended INSIDE-TO-DMZ
 permit ip 200.200.0.0 0.0.255.255 host 200.200.2.2
 permit ip 200.200.0.0 0.0.255.255 host 200.200.4.2
ip access-list extended INSIDE-TO-DMZ2
 permit ip host 200.200.1.2 host 200.200.3.2
 permit ip host 200.200.3.2 host 200.200.1.2
 permit ip 200.200.16.0 0.0.0.255 host 200.200.3.2
 permit ip 200.200.16.0 0.0.0.255 host 200.200.1.2
 permit ip 200.200.0.0 0.0.255.255 host 200.200.3.2
ip access-list extended INSIDE-TO-OUTSIDE
 permit ip 200.200.0.0 0.0.255.255 any
ip access-list extended MANAGEMENT
 permit tcp 200.200.16.0 0.0.0.255 any eq 22
 permit tcp host 200.200.2.2 any eq 22
 permit tcp any any eq 22
 permit ospf any any
ip access-list extended OSPF
 permit ospf 200.200.16.0 0.0.0.255 200.200.16.0 0.0.0.255
ip access-list extended OUTSIDE-TO-DMZ2
 permit ip any host 200.200.3.2
 permit ip any host 200.200.1.2
ip access-list extended OUTSIDE-TO-INSIDE
 permit ip 200.50.1.0 0.0.0.255 host 200.200.3.2
 permit ip 200.60.1.0 0.0.0.255 host 200.200.3.2
 permit ip 200.50.1.0 0.0.0.255 host 200.200.2.2
 permit ip 200.60.1.0 0.0.0.255 host 200.200.2.2
 permit ip 200.50.1.0 0.0.0.255 host 200.200.4.2
 permit ip 200.60.1.0 0.0.0.255 host 200.200.4.2
 permit ip 200.50.1.0 0.0.0.255 host 200.200.1.2
 permit ip 200.60.1.0 0.0.0.255 host 200.200.1.2
 permit ip 200.200.16.0 0.0.0.255 host 200.200.2.2
 permit udp any host 200.200.3.2 eq domain
ip access-list extended RADIUS-ACL
 permit udp 200.200.16.0 0.0.0.255 host 200.200.3.2 eq 1645
 permit udp 200.200.16.0 0.0.0.255 host 200.200.3.2 eq 1646
 permit udp 200.200.16.0 0.0.0.255 host 200.200.4.2 eq 1645
 permit udp 200.200.16.0 0.0.0.255 host 200.200.4.2 eq 1646
 permit udp 200.200.16.0 0.0.0.255 host 200.200.2.2 eq ntp
ip access-list extended SSH
 permit tcp 200.200.16.0 0.0.0.255 200.200.16.0 0.0.0.255 eq 22 log
 permit udp 200.200.16.0 0.0.0.255 200.200.16.0 0.0.0.255 eq 22 log
 deny   tcp any any
ip access-list extended TEST
 permit ospf any any
!
ip radius source-interface Loopback0 
logging alarm informational
logging source-interface Loopback0
logging 200.200.2.2
snmp-server group gruppd v3 priv match exact 
nls resp-timeout 1
cpd cr-id 1
no cdp log mismatch duplex
!
!
!
!
!
!
radius-server host 200.200.3.2 auth-port 1645 acct-port 1646 key gruppd
!
control-plane
!
!
!
mgcp fax t38 ecm
!
!
!
!
gatekeeper
 shutdown
!
!
line con 0
 exec-timeout 0 0
 privilege level 15
 logging synchronous
 stopbits 1
line aux 0
 exec-timeout 0 0
 privilege level 15
 logging synchronous
 stopbits 1
line vty 0 4
 logging synchronous
 login authentication RADIUS-LOGIN
 transport input ssh
!
ntp server 200.200.2.2
end
